from reportlab.lib import colors
from reportlab.graphics.shapes import *
from reportlab.graphics import renderPDF

data = [
    # Year Month Predicted High Low
    (2013, 6,        62.5,    63.5,    61.5,      120.5,   121.5,   119.5),
    (2013, 7,        65.4,    67.4,    63.4,      122.3,   123.3,   121.3),
    (2013, 8,        68.3,    71.3,    65.3,      124.1,   126.1,   122.1),
    (2013, 9,        71.4,    76.4,    66.4,      126.5,   129.5,   123.5),
    (2013, 10,        73.0,    78.0,    68.0,      128.0,   132.0,   124.0),
    (2013, 11,        73.7,    79.7,    67.7,      128.6,   132.6,   124.6),
    (2013, 12,        75.0,    82.0,    68.0,      129.7,   134.7,   124.7),
    (2014, 1,        77.2,    84.2,    70.2,      131.3,   137.3,   125.3),
    (2014, 2,        78.7,    86.7,    70.7,      132.7,   139.7,   125.7),
    (2014, 3,        80.9,    89.9,    71.9,      134.6,   142.6,   126.6),
    (2014, 4,        82.2,    91.2,    73.2,      135.5,   143.5,   127.5),
    (2014, 5,        81.7,    91.7,    71.7,      134.5,   143.5,   125.5),
    (2014, 6,        81.0,    91.0,    71.0,      133.1,   142.1,   124.1),
    (2014, 7,        80.2,    90.2,    70.2,      132.3,   141.3,   123.3),
    (2014, 8,        78.9,    88.9,    68.9,      131.2,   140.2,   122.2),
    (2014, 9,        77.6,    87.6,    67.6,      129.9,   138.9,   120.9),
    (2014, 10,        76.2,    86.2,    66.2,      128.7,   137.7,   119.7),
    (2014, 11,        74.8,    84.8,    64.8,      127.4,   136.4,   118.4),
    (2014, 12,        73.3,    83.3,    63.3,      126.0,   135.0,   117.0),
    (2015, 1,        71.8,    81.8,    61.8,      124.6,   133.6,   115.6),
    (2015, 2,        70.2,    80.2,    60.2,      123.2,   132.2,   114.2),
    (2015, 3,        68.7,    78.7,    58.7,      121.7,   130.7,   112.7),
    (2015, 4,        67.0,    77.0,    57.0,      120.2,   129.2,   111.2),
    (2015, 5,        65.4,    75.4,    55.4,      118.7,   127.7,   109.7),
    (2015, 6,        63.8,    73.8,    53.8,      117.2,   126.2,   108.2),
    (2015, 7,        62.1,    72.1,    52.1,      115.7,   124.7,   106.7),
    (2015, 8,        60.4,    70.4,    50.4,      114.1,   123.1,   105.1),
    (2015, 9,        58.7,    68.7,    48.7,      112.6,   121.6,   103.6),
    (2015, 10,        57.0,    67.0,    47.0,      111.0,   120.0,   102.0),
    (2015, 11,        55.3,    65.3,    45.3,      109.5,   118.5,   100.5),
    (2015, 12,        53.6,    63.6,    43.6,      107.9,   116.9,    98.9),
    (2016, 1,        51.9,    61.9,    41.9,      106.3,   115.3,    97.3),
    (2016, 2,        50.2,    60.2,    40.2,      104.8,   113.8,    95.8),
    (2016, 3,        48.5,    58.5,    38.5,      103.2,   112.2,    94.2),
    (2016, 4,        46.9,    56.9,    36.9,      101.7,   110.7,    92.7),
    (2016, 5,        45.2,    55.2,    35.2,      100.2,   109.2,    91.2),
    (2016, 6,        43.6,    53.6,    33.6,       98.7,   107.7,    89.7),
    (2016, 7,        42.0,    52.0,    32.0,       97.2,   106.2,    88.2),
    (2016, 8,        40.4,    50.4,    30.4,       95.8,   104.8,    86.8),
    (2016, 9,        38.8,    48.8,    28.8,       94.3,   103.3,    85.3),
    (2016, 10,        37.3,    47.3,    27.3,       92.9,   101.9,    83.9),
    (2016, 11,        35.7,    45.7,    25.7,       91.5,   100.5,    82.5),
    (2016, 12,        34.3,    44.3,    24.3,       90.2,    99.2,    81.2),
]

drawing = Drawing(200, 150)

pred = [row[2]-40 for row in data]
high = [row[3]-40 for row in data]
low = [row[4]-40 for row in data]
times = [200*((row[0] + row[1]/12.0) - 2007)-110 for row in data]

drawing.add(PolyLine(zip(times, pred), strokeColor=colors.blue))
drawing.add(PolyLine(zip(times, high), strokeColor=colors.red))
drawing.add(PolyLine(zip(times, low), strokeColor=colors.green))

drawing.add(String(65, 115, 'Sunspots', fontSize=18, fillColor=colors.red))

renderPDF.drawToFile(drawing, 'report.pdf', 'Sunspots')
